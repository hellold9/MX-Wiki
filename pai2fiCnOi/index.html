<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Note 17. æ€§èƒ½åŠ é€Ÿ | æ¯›çº¿ç™¾ç§‘MX Wiki</title>
<meta name="description" content="æ¬¢è¿æ¥åˆ°æ¯›çº¿ç™¾ç§‘!æ¯›çº¿ç™¾ç§‘ MX-Wikiæˆç«‹äº2025 å¹´ï¼Œ çƒ­çˆ±å¦‚æ˜Ÿç«ï¼Œç‚¹èšè€Œç‡åŸ" />
<link rel="shortcut icon" href="https://mx.nna.lat/favicon.ico">
<link rel="stylesheet" href="https://mx.nna.lat/styles/main.css">

<script src="https://mx.nna.lat/media/js/jquery.min.js"></script>
<script src="https://mx.nna.lat/media/js/masonry.pkgd.min.js"></script>
<script src="https://mx.nna.lat/media/js/aos.js"></script>
<script src="https://mx.nna.lat/media/js/pace.min.js"></script>
<script src="https://mx.nna.lat/media/js/view-image.min.js"></script>
<script src="https://mx.nna.lat/media/js/jquery.magnific-popup.min.js"></script>
<script src="https://mx.nna.lat/media/js/functions.js"></script>
    <meta name="referrer" content="never">
    <meta name="description" content="æ–‡/Prorise

Note 17. æ€§èƒ½åŠ é€Ÿï¼šSpring Cache ä¸ Redis åˆ†å¸ƒå¼ç¼“å­˜
{% note default flat %}
æ‘˜è¦: æœ¬ç« æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åˆ©ç”¨ ç¼“å­˜ è§£å†³æ•°æ®åº“è¯»å‹åŠ›è¿‡å¤§çš„é—®é¢˜ã€‚æˆ‘ä»¬å°†å¼•å…¥ä¸šç•Œæ ‡å‡†çš„ ..." />
    <meta name="keywords" content="" />
    <script src="https://mx.nna.lat/media/js/waterfall.min.js"></script>
    <script src="https://mx.nna.lat/media/js/prism.min.js"></script>
  </head>
  <body>
            <header id="header" class="grid-container">
        <!-- start: .menu-wrapper -->
        <div class="menu-mobile"> 
          <i class="fa fa-reorder"></i>
        </div>
        <div class="menu-wrapper">
          <div class="">
            <div class="logo">
              <a href="https://mx.nna.lat"><img src="\media\images\custom-headerLogo.png" alt=""></a>
            </div>
            <!-- start: .main-nav -->

            <nav class="main-nav grid-container grid-parent">
              <ul id="menu-header" class="menu gradient-effect">
                <li class=""><a href="https://mx.nna.lat" class="menu">é¦–é¡µ</a></li>
                
                  <li class="" >
                    <a href="/friends" class="menu">
                      äººç‰©ä¸€è§ˆ
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="/ii" class="menu">
                      æ›´æ–°æ—¥å¿—
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="https://mx.nna.lat/group" class="menu">
                      åŠ å…¥è¯»ç¼–äº¤æµç¾¤
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="/find.html" class="menu">
                      ç¼–å·æŸ¥è¯¢
                    </a>
                  </li>
                
                <li class="search-menu-item hide-on-mobile hide-on-tablet"><a href="#search-lightbox" class="lightbox mfp-inline"><i class="fa fa-search-line"></i></a></li>
              </ul>
            </nav>
            <a href="#search-lightbox" class="lightbox epcl-search-button mfp-inline hide-on-tablet hide-on-desktop"><i class="fa fa-search-line"></i></a>
            <!-- end: .main-nav -->
            <div class="clear"></div>
            <div class="border hide-on-tablet hide-on-mobile"></div>
          </div>    
          <div class="clear"></div>
        </div>
        <!-- end: .menu-wrapper -->
        <div class="clear"></div>
      </header>
      <div class="hide-on-mobile hide-on-tablet hide-on-desktop">
        <div id="search-lightbox" class="grid-container grid-small grid-parent mfp-hide">
          <div class="search-wrapper section">
            <form id="gridea-search-form" data-update="1766318686562" action="/search/index.html" class="search-form" _lpchecked="1">
              <input type="text" name="q" id="s" value="" class="search-field" placeholder="æœç‚¹å•¥..." aria-label="æœç‚¹å•¥..." required="">
              <button type="submit" class="submit" aria-label="Submit">
                <i class="fa fa-search-line"></i>
              </button>
            </form>
          </div>
        </div>
      </div>

      <main id="single" class="main grid-container fullcover no-sidebar aos-init aos-animate" data-aos="fade">

        <div class="center content">
          <div class="featured-image cover" style="background-image: url('https://mx.nna.lat/post-images/pai2fiCnOi.webp');">
            <div class="meta top"> 
              <time class="meta-info" style="float:left;" datetime="2025-12-16"><i class="fa fa-calendar"></i><span class="lately">5 å¤©å‰</span></time>
              
              <a href="https://mx.nna.lat/pai2fiCnOi/#comments" class="comments meta-info" title="">
                <i class="fa fa-comment remixicon"></i><span class="comment-count valine-comment-count" data-xid="/pai2fiCnOi/"> </span>
              </a>
              <span id="/pai2fiCnOi/" class="leancloud_visitors views-counter meta-info" title=""><i class="fa fa-leancloud remixicon"></i><span class="leancloud-visitors-count"></span></span>
              
            </div>
            <div class="info">
              <div class="tags ">
                
              </div>
              <h1 class="title ularge white bold">Note 17. æ€§èƒ½åŠ é€Ÿ</h1>
            </div>
          </div>
        </div>  

        <div class="epcl-page-wrapper">
          <div class="left-content grid-70 np-mobile">
            <article class="main-article post">
              <section class="post-content">
                <div class="text">
                  <p>æ–‡/Prorise</p>
<!-- more -->
<h1 id="note-17-æ€§èƒ½åŠ é€Ÿspring-cache-ä¸-redis-åˆ†å¸ƒå¼ç¼“å­˜">Note 17. æ€§èƒ½åŠ é€Ÿï¼šSpring Cache ä¸ Redis åˆ†å¸ƒå¼ç¼“å­˜</h1>
<p>{% note default flat %}<br>
<strong>æ‘˜è¦</strong>: æœ¬ç« æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åˆ©ç”¨ <strong>ç¼“å­˜</strong> è§£å†³æ•°æ®åº“è¯»å‹åŠ›è¿‡å¤§çš„é—®é¢˜ã€‚æˆ‘ä»¬å°†å¼•å…¥ä¸šç•Œæ ‡å‡†çš„ <strong>Redis</strong>ï¼Œå¹¶æŒæ¡ Spring Cache çš„æ ¸å¿ƒæŠ½è±¡ï¼ˆ<code>@Cacheable</code> ä¸‰å‰‘å®¢ï¼‰ã€‚æˆ‘ä»¬å°†é‡ç‚¹è§£å†³ Redis çš„ <strong>JSON åºåˆ—åŒ–é…ç½®</strong> è¿™ä¸€å…³é”®ç—›ç‚¹ï¼Œå¹¶å®æˆ˜æ¼”ç¤ºå¦‚ä½•é€šè¿‡æ³¨è§£å®ç°è‡ªåŠ¨çš„ç¼“å­˜è¯»å†™ä¸å¤±æ•ˆç®¡ç†ã€‚<br>
{% endnote %}</p>
<p><strong>æœ¬ç« å­¦ä¹ è·¯å¾„</strong></p>
<ol>
<li><strong>æ¶æ„è®¤çŸ¥</strong>ï¼šç†è§£ Spring Cache æŠ½è±¡å±‚ä¸ Redis å®ç°å±‚çš„å…³ç³»ã€‚</li>
<li><strong>ç¯å¢ƒé›†æˆ</strong>ï¼šå¼•å…¥ Redis ä¾èµ–ï¼Œé…ç½®è¿æ¥æ± ã€‚</li>
<li><strong>å…³é”®é…ç½®</strong>ï¼š<strong>è‡ªå®šä¹‰ CacheManager</strong>ï¼Œå°†é»˜è®¤çš„ JDK äºŒè¿›åˆ¶åºåˆ—åŒ–æ”¹ä¸ºé€šç”¨çš„ JSON æ ¼å¼ã€‚</li>
<li><strong>ä¸šåŠ¡å®æˆ˜</strong>ï¼šä½¿ç”¨æ³¨è§£æ”¹é€  Service å±‚ï¼Œå®ç°è‡ªåŠ¨ç¼“å­˜ã€‚</li>
</ol>
<hr>
<h2 id="171-ç¼“å­˜æŠ½è±¡spring-cache-çš„è®¾è®¡å“²å­¦">17.1. ç¼“å­˜æŠ½è±¡ï¼šSpring Cache çš„è®¾è®¡å“²å­¦</h2>
<p>Spring Cache ä¸æ˜¯ä¸€ç§å…·ä½“çš„ç¼“å­˜å®ç°ï¼ˆåƒ Redis æˆ– Ehcache é‚£æ ·ï¼‰ï¼Œè€Œæ˜¯ä¸€å¥— <strong>æ¥å£è§„èŒƒ</strong>ï¼ˆç±»ä¼¼ JDBCï¼‰ã€‚</p>
<p>å®ƒçš„æ ¸å¿ƒç†å¿µæ˜¯ï¼š<strong>ä¸šåŠ¡ä»£ç åªä¸æ³¨è§£æ‰“äº¤é“ï¼Œä¸å…³å¿ƒåº•å±‚ç”¨ä»€ä¹ˆç¼“å­˜</strong>ã€‚</p>
<h3 id="1711-æ³¨è§£ä¸‰å‰‘å®¢">17.1.1. æ³¨è§£ä¸‰å‰‘å®¢</h3>
<table>
<thead>
<tr>
<th style="text-align:left">æ³¨è§£</th>
<th style="text-align:left">æ ¸å¿ƒä½œç”¨</th>
<th style="text-align:left">æ‰§è¡Œæ—¶æœº</th>
<th style="text-align:left">é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong><code>@Cacheable</code></strong></td>
<td style="text-align:left"><strong>æŸ¥ç¼“å­˜</strong></td>
<td style="text-align:left">æ–¹æ³•æ‰§è¡Œ <strong>å‰</strong>ã€‚å‘½ä¸­åˆ™ç›´æ¥è¿”å›ï¼Œæœªå‘½ä¸­åˆ™æ‰§è¡Œæ–¹æ³•å¹¶å­˜å…¥ç¼“å­˜ã€‚</td>
<td style="text-align:left"><strong>æŸ¥è¯¢</strong> (SELECT)</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>@CachePut</code></strong></td>
<td style="text-align:left"><strong>æ›´æ–°ç¼“å­˜</strong></td>
<td style="text-align:left">æ–¹æ³•æ‰§è¡Œ <strong>å</strong>ã€‚å°†æ–¹æ³•çš„è¿”å›å€¼æ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚</td>
<td style="text-align:left"><strong>æ–°å¢/ä¿®æ”¹</strong> (INSERT/UPDATE)</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>@CacheEvict</code></strong></td>
<td style="text-align:left"><strong>åˆ ç¼“å­˜</strong></td>
<td style="text-align:left">æ–¹æ³•æ‰§è¡Œ <strong>å</strong>ï¼ˆé»˜è®¤ï¼‰ã€‚ä»ç¼“å­˜ä¸­ç§»é™¤æŒ‡å®šæ•°æ®ã€‚</td>
<td style="text-align:left"><strong>åˆ é™¤</strong> (DELETE)</td>
</tr>
</tbody>
</table>
<h3 id="1712-æ ¸å¿ƒå±æ€§">17.1.2. æ ¸å¿ƒå±æ€§</h3>
<ul>
<li><strong><code>value</code> / <code>cacheNames</code></strong>ï¼šç¼“å­˜çš„åç§°ï¼ˆç›¸å½“äº Redis ä¸­çš„ Key å‰ç¼€ï¼Œæˆ–å‘½åç©ºé—´ï¼‰ã€‚</li>
<li><strong><code>key</code></strong>ï¼šç¼“å­˜çš„å”¯ä¸€æ ‡è¯†ã€‚æ”¯æŒ <strong>SpEL è¡¨è¾¾å¼</strong>ï¼ˆå¦‚ <code>#id</code>, <code>#user.id</code>ï¼‰ã€‚</li>
</ul>
<hr>
<h2 id="172-å®æˆ˜-é›†æˆ-redis">17.2. [å®æˆ˜] é›†æˆ Redis</h2>
<p>è™½ç„¶ Spring Boot æ”¯æŒç®€å•çš„ Map å†…å­˜ç¼“å­˜ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œ<strong>Redis</strong> æ˜¯åˆ†å¸ƒå¼ç¼“å­˜çš„å”¯ä¸€é€‰æ‹©ã€‚</p>
<h3 id="1721-å¼•å…¥ä¾èµ–">17.2.1. å¼•å…¥ä¾èµ–</h3>
<p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>pom.xml</code></p>
<pre><code class="language-xml">&lt;dependencies&gt;
    &lt;!-- Redis æ ¸å¿ƒä¾èµ– --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
    &lt;/dependency&gt;
    
    &lt;!-- è¿æ¥æ± ä¾èµ– (Spring Boot 2.x+ é»˜è®¤ä½¿ç”¨ Lettuceï¼Œæ¨èé…åˆè¿æ¥æ± ) --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
        &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>
<h3 id="1722-é…ç½®è¿æ¥">17.2.2. é…ç½®è¿æ¥</h3>
<p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>src/main/resources/application.yml</code></p>
<pre><code class="language-yaml">spring:
  data:
    redis:
      host: localhost
      port: 6379
      # password: 123456
      database: 0
      lettuce:
        pool:
          max-active: 8 # æœ€å¤§è¿æ¥æ•°
          max-wait: -1ms # æœ€å¤§ç­‰å¾…æ—¶é—´
</code></pre>
<h3 id="1723-å¼€å¯ç¼“å­˜">17.2.3. å¼€å¯ç¼“å­˜</h3>
<p>åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£ã€‚</p>
<p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>src/main/java/com/example/demo/DemoApplication.java</code></p>
<pre><code class="language-java">@EnableCaching // å…³é”®ï¼šå¼€å¯ç¼“å­˜æ³¨è§£æ”¯æŒ
@SpringBootApplication
public class DemoApplication { ... }
</code></pre>
<hr>
<h2 id="173-å…³é”®-é…ç½®-json-åºåˆ—åŒ–">17.3. [å…³é”®] é…ç½® JSON åºåˆ—åŒ–</h2>
<p><strong>ç—›ç‚¹</strong>ï¼š<br>
Spring Boot é»˜è®¤ä½¿ç”¨ JDK åºåˆ—åŒ– (<code>JdkSerializationRedisSerializer</code>)ã€‚</p>
<ul>
<li><strong>ç¼ºç‚¹</strong>ï¼šç”Ÿæˆçš„ Redis æ•°æ®æ˜¯ä¹±ç ï¼ˆäºŒè¿›åˆ¶æµï¼‰ï¼Œæ— æ³•äººå·¥é˜…è¯»ï¼Œä¸” Java å¯¹è±¡å¿…é¡»å®ç° <code>Serializable</code> æ¥å£ã€‚</li>
<li><strong>ç›®æ ‡</strong>ï¼šæˆ‘ä»¬å¸Œæœ› Redis é‡Œå­˜çš„æ˜¯æ¸…æ™°çš„ <strong>JSON</strong> å­—ç¬¦ä¸²ã€‚</li>
</ul>
<p>æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ <code>RedisCacheConfiguration</code>ã€‚</p>
<p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>src/main/java/com/example/demo/config/CacheConfig.java</code></p>
<pre><code class="language-java">package com.example.demo.config;

import org.springframework.boot.autoconfigure.cache.RedisCacheManagerBuilderCustomizer;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.cache.RedisCacheConfiguration;
import org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer;
import org.springframework.data.redis.serializer.RedisSerializationContext;
import org.springframework.data.redis.serializer.StringRedisSerializer;

import java.time.Duration;

@Configuration
@EnableCaching
public class CacheConfig {

    /**
     * é…ç½® Redis ç¼“å­˜çš„åºåˆ—åŒ–æ–¹å¼å’Œè¿‡æœŸæ—¶é—´
     */
    @Bean
    public RedisCacheConfiguration redisCacheConfiguration() {
        return RedisCacheConfiguration.defaultCacheConfig()
                // 1. è®¾ç½® Key ä¸º String åºåˆ—åŒ–
                .serializeKeysWith(RedisSerializationContext.SerializationPair.fromSerializer(new StringRedisSerializer()))
                // 2. è®¾ç½® Value ä¸º JSON åºåˆ—åŒ– (GenericJackson2JsonRedisSerializer)
                .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(new GenericJackson2JsonRedisSerializer()))
                // 3. è®¾ç½®é»˜è®¤è¿‡æœŸæ—¶é—´ä¸º 1 å°æ—¶ (é˜²æ­¢ç¼“å­˜é›ªå´©)
                .entryTtl(Duration.ofHours(1))
                // 4. ä¸ç¼“å­˜ null å€¼
                .disableCachingNullValues();
    }
}
</code></pre>
<hr>
<h2 id="174-å®æˆ˜-æ”¹é€ -service-å±‚">17.4. [å®æˆ˜] æ”¹é€  Service å±‚</h2>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬ä¸º <code>UserService</code> æ·»åŠ ç¼“å­˜é€»è¾‘ã€‚</p>
<p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>src/main/java/com/example/demo/service/impl/UserServiceImpl.java</code></p>
<pre><code class="language-java">@Service
public class UserServiceImpl implements UserService {

    @Autowired
    private UserMapper userMapper;

    /**
     * æŸ¥è¯¢ï¼šå…ˆæŸ¥ç¼“å­˜ï¼Œæ²¡æœ‰å†æŸ¥åº“
     * cacheNames = &quot;users&quot;: Redis Key çš„å‰ç¼€
     * key = &quot;#id&quot;: ä½¿ç”¨å‚æ•° id ä½œä¸º Key çš„åç¼€
     * æœ€ç»ˆ Redis Key: &quot;users::1&quot;
     */
    @Override
    @Cacheable(cacheNames = &quot;users&quot;, key = &quot;#id&quot;)
    public UserVO getUserById(Long id) {
        // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œï¼ŒéªŒè¯ç¼“å­˜æ˜¯å¦ç”Ÿæ•ˆ
        System.out.println(&quot;--- æŸ¥è¯¢æ•°æ®åº“ ---&quot;);
        User user = userMapper.selectById(id);
        return convertToVO(user);
    }

    /**
     * æ›´æ–°ï¼šä¿®æ”¹æ•°æ®åº“åï¼Œè‡ªåŠ¨æ›´æ–°ç¼“å­˜
     * æ³¨æ„ï¼šæ–¹æ³•è¿”å›å€¼å¿…é¡»æ˜¯æ›´æ–°åçš„æ•°æ®ï¼ŒSpring ä¼šæŠŠè¿”å›å€¼æ”¾å…¥ç¼“å­˜
     */
    @Override
    @CachePut(cacheNames = &quot;users&quot;, key = &quot;#user.id&quot;)
    public UserVO updateUser(User user) {
        userMapper.updateById(user);
        return convertToVO(userMapper.selectById(user.getId()));
    }

    /**
     * åˆ é™¤ï¼šåˆ é™¤æ•°æ®åº“åï¼Œè‡ªåŠ¨åˆ é™¤ç¼“å­˜
     */
    @Override
    @CacheEvict(cacheNames = &quot;users&quot;, key = &quot;#id&quot;)
    public void deleteUser(Long id) {
        userMapper.deleteById(id);
    }
}
</code></pre>
<hr>
<h2 id="175-éªŒè¯æ•ˆæœ">17.5. éªŒè¯æ•ˆæœ</h2>
<ol>
<li>
<p><strong>ç¬¬ä¸€æ¬¡æŸ¥è¯¢</strong>ï¼š</p>
<ul>
<li>è°ƒç”¨ <code>GET /users/1</code>ã€‚</li>
<li>æ§åˆ¶å°æ‰“å° <code>--- æŸ¥è¯¢æ•°æ®åº“ ---</code>ã€‚</li>
<li>Redis ä¸­å‡ºç° Key <code>users::1</code>ï¼ŒValue ä¸º JSON å­—ç¬¦ä¸²ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç¬¬äºŒæ¬¡æŸ¥è¯¢</strong>ï¼š</p>
<ul>
<li>å†æ¬¡è°ƒç”¨ <code>GET /users/1</code>ã€‚</li>
<li>æ§åˆ¶å° <strong>æ²¡æœ‰</strong> æ‰“å°æ—¥å¿—ï¼Œè¯´æ˜æ•°æ®åº“æœªè¢«è®¿é—®ï¼Œç›´æ¥èµ°äº†ç¼“å­˜ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ›´æ–°æ•°æ®</strong>ï¼š</p>
<ul>
<li>è°ƒç”¨ <code>POST /users/update</code> ä¿®æ”¹æ•°æ®ã€‚</li>
<li>Redis ä¸­çš„ <code>users::1</code> å€¼è‡ªåŠ¨æ›´æ–°ã€‚</li>
</ul>
</li>
<li>
<p><strong>å†æ¬¡æŸ¥è¯¢</strong>ï¼š</p>
<ul>
<li>è°ƒç”¨ <code>GET /users/1</code>ï¼Œè¿”å›çš„æ˜¯æ›´æ–°åçš„æ–°æ•°æ®ã€‚</li>
</ul>
</li>
</ol>
<hr>
<h2 id="176-æœ¬ç« æ€»ç»“ä¸ç¼“å­˜é€ŸæŸ¥">17.6. æœ¬ç« æ€»ç»“ä¸ç¼“å­˜é€ŸæŸ¥</h2>
<p><strong>æ‘˜è¦å›é¡¾</strong><br>
æœ¬ç« æˆ‘ä»¬ä¸ºåº”ç”¨è£…ä¸Šäº†â€œåŠ é€Ÿå™¨â€ã€‚é€šè¿‡é›†æˆ Redis å’Œ Spring Cacheï¼Œæˆ‘ä»¬ä»…ç”¨å‡ ä¸ªæ³¨è§£å°±å®ç°äº†æ ‡å‡†çš„ç¼“å­˜è¯»å†™ç­–ç•¥ï¼ˆCache-Aside Patternï¼‰ã€‚ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ JSON åºåˆ—åŒ–çš„é…ç½®ï¼Œè¿™æ˜¯è®© Redis æ•°æ®å…·å¤‡å¯è¯»æ€§å’Œé€šç”¨æ€§çš„å…³é”®ã€‚</p>
<p><strong>é‡åˆ°ä»¥ä¸‹ 3 ç§ç¼“å­˜åœºæ™¯æ—¶ï¼Œè¯·ç›´æ¥å‚è€ƒä»£ç æ¨¡ç‰ˆï¼š</strong></p>
<h3 id="1-åœºæ™¯ä¸€æ ‡å‡†å•ä½“æŸ¥è¯¢ç¼“å­˜">1. åœºæ™¯ä¸€ï¼šæ ‡å‡†å•ä½“æŸ¥è¯¢ç¼“å­˜</h3>
<p><strong>éœ€æ±‚</strong>ï¼šæ ¹æ® ID æŸ¥è¯¢è¯¦æƒ…ï¼Œç¼“å­˜ 1 å°æ—¶ï¼ˆé…ç½®ä¸­è®¾ç½®ï¼‰ã€‚<br>
<strong>æ¨¡ç‰ˆ</strong>ï¼š</p>
<pre><code class="language-java">@Cacheable(cacheNames = &quot;product&quot;, key = &quot;#id&quot;)
public Product getProduct(Long id) { ... }
</code></pre>
<h3 id="2-åœºæ™¯äºŒç»„åˆé”®ç¼“å­˜">2. åœºæ™¯äºŒï¼šç»„åˆé”®ç¼“å­˜</h3>
<p><strong>éœ€æ±‚</strong>ï¼šæ ¹æ®â€œç±»å‹â€å’Œâ€œåŸå¸‚â€æŸ¥è¯¢åˆ—è¡¨ï¼ŒKey éœ€è¦å”¯ä¸€ã€‚<br>
<strong>æ¨¡ç‰ˆ</strong>ï¼š</p>
<pre><code class="language-java">// Redis Key: &quot;shops::Food:Beijing&quot;
@Cacheable(cacheNames = &quot;shops&quot;, key = &quot;#type + ':' + #city&quot;)
public List&lt;Shop&gt; getShops(String type, String city) { ... }
</code></pre>
<h3 id="3-åœºæ™¯ä¸‰æ¸…ç©ºæ•´ä¸ªç¼“å­˜åˆ†åŒº">3. åœºæ™¯ä¸‰ï¼šæ¸…ç©ºæ•´ä¸ªç¼“å­˜åˆ†åŒº</h3>
<p><strong>éœ€æ±‚</strong>ï¼šåå°ä¿®æ”¹äº†å…¨å±€é…ç½®ï¼Œéœ€è¦æ¸…ç©ºæ‰€æœ‰ <code>config</code> ç¼“å­˜ã€‚<br>
<strong>æ¨¡ç‰ˆ</strong>ï¼š</p>
<pre><code class="language-java">@CacheEvict(cacheNames = &quot;config&quot;, allEntries = true)
public void reloadConfig() { ... }
</code></pre>
<h3 id="4-æ ¸å¿ƒé¿å‘æŒ‡å—">4. æ ¸å¿ƒé¿å‘æŒ‡å—</h3>
<ol>
<li>
<p><strong>ç¼“å­˜ä¸ç”Ÿæ•ˆ (è‡ªè°ƒç”¨)</strong></p>
<ul>
<li><strong>ç°è±¡</strong>ï¼š<code>this.getUserById(1)</code> ä»ç„¶æŸ¥æ•°æ®åº“ã€‚</li>
<li><strong>åŸå› </strong>ï¼šå’Œ <code>@Transactional</code> ä¸€æ ·ï¼Œ<code>@Cacheable</code> åŸºäº AOP ä»£ç†ã€‚ç±»å†…éƒ¨è‡ªè°ƒç”¨ä¸èµ°ä»£ç†ã€‚</li>
<li><strong>å¯¹ç­–</strong>ï¼šå¤–éƒ¨è°ƒç”¨ï¼Œæˆ–æ³¨å…¥ <code>self</code> ä»£ç†å¯¹è±¡è°ƒç”¨ã€‚</li>
</ul>
</li>
<li>
<p><strong>åºåˆ—åŒ–å¼‚å¸¸</strong></p>
<ul>
<li><strong>ç°è±¡</strong>ï¼šæŠ¥é”™ <code>NotSerializableException</code> æˆ– JSON è§£æé”™è¯¯ã€‚</li>
<li><strong>åŸå› </strong>ï¼šå¯¹è±¡æ²¡æœ‰æ— å‚æ„é€ å™¨ï¼ˆJackson éœ€è¦ï¼‰ï¼Œæˆ–è€…å­˜å…¥å’Œè¯»å–æ—¶çš„åºåˆ—åŒ–é…ç½®ä¸ä¸€è‡´ã€‚</li>
<li><strong>å¯¹ç­–</strong>ï¼šç¡®ä¿ DTO/VO æœ‰ <code>@Data</code> (å«æ— å‚æ„é€ )ï¼Œä¸” Redis é…ç½®ç»Ÿä¸€ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç¼“å­˜ä¸€è‡´æ€§</strong></p>
<ul>
<li><strong>ç°è±¡</strong>ï¼šæ•°æ®åº“æ”¹äº†ï¼Œç¼“å­˜è¿˜æ˜¯æ—§çš„ã€‚</li>
<li><strong>åŸå› </strong>ï¼šå¿˜è®°åŠ  <code>@CachePut</code> æˆ– <code>@CacheEvict</code>ï¼›æˆ–è€…æ‰‹åŠ¨æ”¹äº†æ•°æ®åº“ä½†æ²¡æ¸…ç¼“å­˜ã€‚</li>
<li><strong>å¯¹ç­–</strong>ï¼šä¿è¯æ‰€æœ‰æ•°æ®ä¿®æ”¹å…¥å£éƒ½åŠ ä¸Šäº†ç¼“å­˜æ›´æ–°æ³¨è§£ï¼›è®¾ç½®åˆç†çš„ TTL (è¿‡æœŸæ—¶é—´) ä½œä¸ºæœ€åä¸€é“é˜²çº¿ã€‚</li>
</ul>
</li>
</ol>
<hr>

                </div>
                <div class="clear"></div>
              </section>
            </article>
            <div class="clear"></div>

            <section class="related section">
              
              <article class="prev grid-50 tablet-grid-50 grid-parent">
                <div class="thumb cover lazy loaded" style="background-image: url('https://mx.nna.lat/post-images/000010.webp');"></div>
                 <a href="https://mx.nna.lat/000010/" class="full-link"></a>
                 <div class="info">
                  <time datetime="2025-12-19">2025-12-19</time>
                  <h4 class="title white no-margin">åˆ˜æ™ºè¾°</h4>
                </div>
                 <span class="epcl-button red">
                  <img src="https://mx.nna.lat/media/images/left-arrow.svg" width="15" alt="Left Arrow">
                </span>
                <div class="overlay"></div>
              </article>
              
              
              <article class="next grid-50 tablet-grid-50 grid-parent">
                <div class="thumb cover lazy loaded" style="background-image: url('https://mx.nna.lat/post-images/000009.webp');"></div>
                 <a href="https://mx.nna.lat/000009/" class="full-link"></a>
                 <div class="info">
                  <time datetime="2025-12-13">2025-12-13</time>
                  <h4 class="title white no-margin">æˆ·æ™¨é£</h4>
                </div>
                 <span class="epcl-button red">
                  <img src="https://mx.nna.lat/media/images/right-arrow.svg" width="15" alt="Left Arrow">
                </span>
                <div class="overlay"></div>
              </article>
              

                <div class="clear"></div>
            </section>

              <div class="clear"></div>
              
            
              <div id="comments" class="bg-white hosted ">
                <div class="clear"></div>
<script>
jQuery(document).ready(function($){
    $('.vemoji-btn').text('ğŸ˜€');
    $("#comments").on('click', 'span.vat',function(){
        $(this).parent('div.vmeta').next("div.vcontent").after($("div.vwrap"));
        $('textarea#veditor').focus();
    })
    if(window.location.hash){
        var checkExist = setInterval(function() {
            if ($(window.location.hash).length) {
                $('html, body').animate({scrollTop: $(window.location.hash).offset().top-200}, 600);
                clearInterval(checkExist);
            }
        }, 100);
    }
})
</script>

              </div>
            

            </div>
          </div>
      </main>

          <footer id="footer" class="grid-container">
        <div class="widgets row gradient-effect">
            <div class="default-sidebar border-effect">
              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="tag_cloud-2" class="widget widget_epcl_posts_thumbs underline-effect">
                  <h4 class="widget-title title white bordered">æœ€æ–°æ–‡ç« </h4>
                  
                  
                  <article class="item post-0 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://mx.nna.lat/000016/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://mx.nna.lat/post-images/000016.webp');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2025-12-20">2025-12-20</time>
                      <h4 class="title usmall">
                        <a href="https://mx.nna.lat/000016/">è¾Ÿé‚ª</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  <article class="item post-1 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://mx.nna.lat/000015/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://mx.nna.lat/post-images/000015.webp');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2025-12-20">2025-12-20</time>
                      <h4 class="title usmall">
                        <a href="https://mx.nna.lat/000015/">ä¹‰å’Œå›¢</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  <article class="item post-2 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://mx.nna.lat/000014/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('https://mx.nna.lat/post-images/000014.webp');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2025-12-20">2025-12-20</time>
                      <h4 class="title usmall">
                        <a href="https://mx.nna.lat/000014/">æˆ‘è¦éªŒç‰Œ</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  <div class="clear"></div>
                </section>
              </div>

              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="tag_cloud-2" class="widget widget_tag_cloud underline-effect">
                  <h4 class="widget-title title white bordered">æ ‡ç­¾</h4>
                  <div class="tagcloud">
                    
                      <a href="https://mx.nna.lat/llsLEc-O9T/" class="ctag ctag-0 ctag-llsLEc-O9T" aria-label="">è¯æ¡</a>
                    
                  </div>
                  <div class="clear"></div>
                </section>
              </div>

              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="epcl_about-2" class="widget widget_epcl_about underline-effect">
                  <h4 class="widget-title title white bordered">å…³äºbkç™¾ç§‘</h4>
                  <div class="avatar">
                    <a href="" class="translate-effect thumb"><span class="fullimage cover" style="background-image: url(https://mx.nna.lat/images/avatar.png);"></span></a>
                  </div>
                  <div class="info">
                    <h4 class="title small author-name gradient-effect no-margin"><a href="">æ¯›çº¿ç™¾ç§‘MX Wiki</a></h4>
                    <p class="founder">æ¬¢è¿æ¥åˆ°æ¯›çº¿ç™¾ç§‘!æ¯›çº¿ç™¾ç§‘ MX-Wikiæˆç«‹äº2025 å¹´ï¼Œ çƒ­çˆ±å¦‚æ˜Ÿç«ï¼Œç‚¹èšè€Œç‡åŸ</p>
                    <div class="social">
                      
                          
                            <a href="https://github.com/hellold9" class="translate-effect" target="_blank"><i class="fa fa-github"></i></a>
                        
                      
                          
                            <a href="https://x.com/huanhuan31556" class="translate-effect" target="_blank"><i class="fa fa-twitter"></i></a>
                        
                      
                        
                      
                        
                      
                        
                      
                    </div> 
                  </div>
                  <div class="clear"></div>
                  </section>
              </div>

            </div>
            <div class="clear"></div>
        </div>

        <div class="logo">
          <a href="https://mx.nna.lat"><img src="\media\images\custom-footerLogo.png" alt=""></a>
        </div>
        <p class="published border-effect">
          Â©2025 å…± 24 ä¸ªæ¡ç›®
          <br/>
          Theme <a href="https://gridea.dev/" target="_blank">ã€Œbreekã€</a> Powered by <a href="https://gridea.dev/" target="_blank">ã€ŒGrideaã€</a>
        </p>
        
        <a href="javascript:void(0)" id="back-to-top" class="epcl-button dark" style="display:none">
          <i class="fa fa-arrow"></i>
        </a>
    </footer>
    
    <div class="clear"></div>

        
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/valine/1.3.10/Valine.Pure.min.js"></script>
<script>
    new Valine({
        el: '#comments',
        appId: 'cgiiQsJurTiUaOW1T8UC5NdH-MdYXbMMI' ,
        appKey: '4nJZkZkO6JkMtEV6F9rp0Vkl',
        pageSize: 30,
        placeholder: 'æ—¢ç„¶æ¥äº†ï¼Œé‚£å°±ç•™ä¸ªç—•è¿¹å§~',
        visitor: false // é˜…è¯»é‡ç»Ÿè®¡
    })
</script>
    

      
    <script src="https://mx.nna.lat/media/js/functions-post.js"></script>

    </div>
    <!-- end: #wrapper -->
  </body>
</html>
